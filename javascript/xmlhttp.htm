<html>
<head>
</head>
<body>
<input type="text" id="realtimeprice"></input>
 <script type="text/javascript">
 	function x(){
	  var   xmlhttp=new   ActiveXObject("Msxml2.xmlhttp");
	  xmlhttp.open("GET","http://business.sohu.com/",false)  ;
    	  
	  xmlhttp.send()  ;	 
	  return xmlhttp.ResponseBody;
	}
	
	//reload();
	var timeStart=new Date().getTime();
	var rawData=x();
	//alert(rawData[0]);
	var timeMiddle=new Date().getTime();
	//alert((timeMiddle-timeStart)/1000);
	//setInterval(reload,1000);//每两秒钟更新一次
	</script>
	
  <SCRIPT language="VBScript">
Function URLEncoding(vstrIn)
    strReturn = ""
    For i = 1 To Len(vstrIn)
        ThisChr = Mid(vStrIn,i,1)
        If Abs(Asc(ThisChr)) < &HFF Then
            strReturn = strReturn & ThisChr
        Else
            innerCode = Asc(ThisChr)
            If innerCode < 0 Then
                innerCode = innerCode + &H10000
            End If
            Hight8 = (innerCode  And &HFF00)\ &HFF
            Low8 = innerCode And &HFF
            strReturn = strReturn & "%" & Hex(Hight8) &  "%" & Hex(Low8)
        End If
    Next
    URLEncoding = strReturn
End Function

Function bytes2BSTR(vIn)
    strReturn = ""
    For i = 1 To LenB(vIn)
        ThisCharCode = AscB(MidB(vIn,i,1))
        If ThisCharCode < &H80 Then
            strReturn = strReturn & Chr(ThisCharCode)
        Else
            NextCharCode = AscB(MidB(vIn,i+1,1))
            strReturn = strReturn & Chr(CLng(ThisCharCode) * &H100 + CInt(NextCharCode))
            i = i + 1
        End If
    Next
    bytes2BSTR = strReturn
End Function

cData = bytes2BSTR(rawData)
</SCRIPT>
<script language="javascript">
alert(cData);
var timeEnd=new Date().getTime();
alert("duration:"+(timeEnd-timeStart)/1000+" sec");
</script>
</body>   
